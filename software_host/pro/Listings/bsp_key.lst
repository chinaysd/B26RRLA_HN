C51 COMPILER V9.59.0.0   BSP_KEY                                                           06/14/2019 09:16:02 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE BSP_KEY
OBJECT MODULE PLACED IN .\Objects\bsp_key.obj
COMPILER INVOKED BY: E:\MDK\C51\BIN\C51.EXE ..\bsp\bsp_key.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\bsp;..\lib;..\TimeOut;..
                    -\user) DEBUG OBJECTEXTEND PRINT(.\Listings\bsp_key.lst) TABS(7) OBJECT(.\Objects\bsp_key.obj)

line level    source

   1          #include "bsp_key.h"
   2          
   3          
   4          extern LOCK_PARA_t Lock_Para_t;
   5          
   6          char TX0SendData,TX1SendData;
   7          unsigned long int MyKeyValue,KEYTempVALUE;
   8          TIMEOUT_PARA TimeOut_Para[2];
   9          
  10          extern char count_level;
  11          
  12          char FootLedTempCnts;
  13          
  14          void RevDataFootLedOpen(void)
  15          {
  16   1             KEYTempVALUE = NON_VALUE;
  17   1             TX0SendData = LedOpenData;  //往下发的指令
  18   1          count_level = 100;
  19   1      }
  20          
  21          void RevDataFootLedClose(void)
  22          {
  23   1             KEYTempVALUE = NON_VALUE;
  24   1             TX0SendData = LedCloseData; //往下发的指令
  25   1             count_level = 15;
  26   1      }
  27          
  28          void KeyDataOnLineSend(void)
  29          {
  30   1             if(TimeOutDet_Check(&TimeOut_Para[0]))
  31   1             {
  32   2                    TimeOut_Record(&TimeOut_Para[0],OneLineTime);
  33   2                    Uart0_ProtocolSend(0xfa,0xfb,TX0SendData);       
  34   2                    Uart1_ProtocolSendData(0xfa,0xfb,TX1SendData);
  35   2             }
  36   1      }
  37          
  38          void Key_Handle(void)
  39          {
  40   1             if(SOCAPI_TouchKeyStatus&0x80) 
  41   1             {
  42   2                    SOCAPI_TouchKeyStatus &= 0x7f;
  43   2                    MyKeyValue = TouchKeyScan();
  44   2                    switch (MyKeyValue)
  45   2                    {
  46   3                           case TK1_VALUE:
  47   3                                  if((KEYTempVALUE != TK1_VALUE)&&(Lock_Para_t.LockFlag)){
  48   4                        KEYTempVALUE = TK1_VALUE;
  49   4                                    ++ FootLedTempCnts;
  50   4                                    if(FootLedTempCnts & 0x01){
  51   5                                         TX0SendData = LedOpenData;
  52   5                                         TX1SendData = ExtiLedOpenData;
  53   5                                    }
  54   4                                    else{
C51 COMPILER V9.59.0.0   BSP_KEY                                                           06/14/2019 09:16:02 PAGE 2   

  55   5                                         TX0SendData = LedCloseData;
  56   5                                         TX1SendData = ExtiLedCloseData;
  57   5                                    }
  58   4                                    PwmHandle();
  59   4                                  }
  60   3                                  break;
  61   3                           case TK2_VALUE:
  62   3                                  if((KEYTempVALUE != TK2_VALUE)&&(Lock_Para_t.LockFlag)){
  63   4                        KEYTempVALUE = TK2_VALUE;
  64   4                                    CupHandle();
  65   4                                  }
  66   3                                  break;
  67   3                           case TK3_VALUE:
  68   3                                  if((KEYTempVALUE != TK3_VALUE)&&(Lock_Para_t.LockFlag)){
  69   4                                    KEYTempVALUE = TK3_VALUE;
  70   4                                    TX0SendData = HeadUpData;
  71   4                                  }
  72   3                                  break;
  73   3                           case TK4_VALUE:
  74   3                                  if((KEYTempVALUE != TK4_VALUE)&&(Lock_Para_t.LockFlag)){
  75   4                                    KEYTempVALUE = TK4_VALUE;
  76   4                                    TX0SendData = HomeData;
  77   4                                  }
  78   3                                  break;
  79   3                           case TK5_VALUE:
  80   3                                  if(KEYTempVALUE != TK5_VALUE){
  81   4                                    KEYTempVALUE = TK5_VALUE;
  82   4                                    //TX0SendData = 0x10;
  83   4                                  }
  84   3                                  break;
  85   3                           case TK6_VALUE:
  86   3                                  if((KEYTempVALUE != TK6_VALUE)&&(Lock_Para_t.LockFlag)){
  87   4                                    KEYTempVALUE = TK6_VALUE;
  88   4                                    TX0SendData = OpenData;
  89   4                                  }
  90   3                                  break;
  91   3                           case TK7_VALUE:
  92   3                                  if((KEYTempVALUE != TK7_VALUE)&&(Lock_Para_t.LockFlag)){
  93   4                                    KEYTempVALUE = TK7_VALUE;
  94   4                                    TX0SendData = CloseData;
  95   4                                  }
  96   3                                  break;
  97   3                           case TK8_VALUE:
  98   3                                  if((KEYTempVALUE != TK8_VALUE)&&(Lock_Para_t.LockFlag)){
  99   4                                    KEYTempVALUE = TK8_VALUE;
 100   4                                    TX0SendData = HeadDownData;
 101   4                                  }
 102   3                                  break;
 103   3                           case 0X0100:
 104   3                                  break;
 105   3                           case 0X0200:
 106   3                                  break;
 107   3                           default:
 108   3                                  if(KEYTempVALUE != NON_VALUE){
 109   4                                    KEYTempVALUE = NON_VALUE;
 110   4                                    TX0SendData = NoData;
 111   4                                  }
 112   3                                  break;
 113   3                    }
 114   2                    TouchKeyRestart();// 启动下一轮转换
 115   2             }
 116   1             RevDataHandle();
C51 COMPILER V9.59.0.0   BSP_KEY                                                           06/14/2019 09:16:02 PAGE 3   

 117   1             KeyDataOnLineSend();
 118   1      }
 119          
 120          
 121          
 122          
 123          
 124          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    584    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     27    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
